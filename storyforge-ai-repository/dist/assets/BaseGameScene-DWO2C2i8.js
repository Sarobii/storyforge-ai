var p=Object.defineProperty;var f=(c,o,t)=>o in c?p(c,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[o]=t;var i=(c,o,t)=>f(c,typeof o!="symbol"?o+"":o,t);import{P as h}from"./index-x1V5TmgY.js";class x extends h.Scene{constructor(t){super({key:t});i(this,"gameState");i(this,"customization");i(this,"controls",{});i(this,"isMobile",!1);i(this,"gameCompleteCallback");i(this,"gameSaveCallback");i(this,"gamePauseCallback");i(this,"isPaused",!1);i(this,"startTime",0);this.gameState={level:1,score:0,lives:3,health:100,inventory:[],position:{x:0,y:0},checkpoints:[],customizations:{},achievements:[],playtime:0}}init(t){this.customization=t.customization||{characterName:"Hero",theme:"classic",difficulty:"medium"},t.savedState&&(this.gameState={...t.savedState}),this.gameCompleteCallback=t.onGameComplete,this.gameSaveCallback=t.onGameSave,this.gamePauseCallback=t.onGamePause,this.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.startTime=Date.now()}create(){this.setupControls(),this.setupUI(),this.setupAudio(),this.time.addEvent({delay:1e3,callback:this.updatePlaytime,callbackScope:this,loop:!0})}setupControls(){var t,s;this.controls.keys=(t=this.input.keyboard)==null?void 0:t.addKeys({up:["UP","W"],down:["DOWN","S"],left:["LEFT","A"],right:["RIGHT","D"],action:["SPACE","ENTER"],pause:["P","ESC"],menu:["M","TAB"]}),this.isMobile&&this.setupMobileControls(),(s=this.controls.keys)==null||s.pause.on("down",()=>{this.togglePause()})}setupMobileControls(){const t=this.add.container(100,this.cameras.main.height-100);t.setScrollFactor(0),t.setDepth(1e3);const s=this.add.circle(0,0,40,3355443,.5),e=this.add.circle(0,0,20,6710886,.8);t.add([s,e]);const a=this.add.circle(this.cameras.main.width-80,this.cameras.main.height-100,35,16739125,.8);a.setScrollFactor(0),a.setDepth(1e3),a.setInteractive();const l=this.add.text(a.x,a.y,"ACT",{fontSize:"14px",color:"#ffffff",fontFamily:"monospace",fontStyle:"bold"});l.setOrigin(.5),l.setScrollFactor(0),l.setDepth(1001);let r=!1;t.setInteractive(new h.Geom.Circle(0,0,40),h.Geom.Circle.Contains),t.on("pointerdown",n=>{r=!0,n.x,n.y}),this.input.on("pointermove",n=>{if(r){const u=h.Math.Distance.Between(s.x,s.y,n.x-t.x,n.y-t.y),m=h.Math.Angle.Between(s.x,s.y,n.x-t.x,n.y-t.y),d=Math.min(u,30);e.x=Math.cos(m)*d,e.y=Math.sin(m)*d,this.controls.mobile={left:e.x<-10,right:e.x>10,up:e.y<-10,down:e.y>10,action:!1}}}),this.input.on("pointerup",()=>{r=!1,e.x=0,e.y=0,this.controls.mobile={left:!1,right:!1,up:!1,down:!1,action:!1}}),a.on("pointerdown",()=>{this.controls.mobile&&(this.controls.mobile.action=!0)}),a.on("pointerup",()=>{this.controls.mobile&&(this.controls.mobile.action=!1)})}setupUI(){const t=this.add.container(0,0);t.setScrollFactor(0),t.setDepth(900);const s=this.add.rectangle(20,20,200,20,3355443);s.setOrigin(0,0);const e=this.add.rectangle(20,20,this.gameState.health/100*200,20,4906624);e.setOrigin(0,0);const a=this.add.text(20,50,`Score: ${this.gameState.score}`,{fontSize:"16px",color:"#ffffff",fontFamily:"monospace",backgroundColor:"#000000",padding:{x:8,y:4}}),l=this.add.text(20,80,`Lives: ${this.gameState.lives}`,{fontSize:"16px",color:"#ffffff",fontFamily:"monospace",backgroundColor:"#000000",padding:{x:8,y:4}});t.add([s,e,a,l]),this.data.set("healthBar",e),this.data.set("scoreText",a),this.data.set("livesText",l)}setupAudio(){try{this.sound.context&&this.sound.context.state==="suspended"&&this.sound.context.resume()}catch(t){console.warn("Audio context not available:",t)}}updateUI(){const t=this.data.get("healthBar"),s=this.data.get("scoreText"),e=this.data.get("livesText");t&&(t.width=this.gameState.health/100*200),s&&s.setText(`Score: ${this.gameState.score}`),e&&e.setText(`Lives: ${this.gameState.lives}`)}updatePlaytime(){this.isPaused||(this.gameState.playtime+=1)}togglePause(){var t;if(this.isPaused=!this.isPaused,this.isPaused){this.scene.pause(),(t=this.gamePauseCallback)==null||t.call(this,this.gameState);const s=this.add.rectangle(this.cameras.main.width/2,this.cameras.main.height/2,this.cameras.main.width,this.cameras.main.height,0,.7);s.setScrollFactor(0),s.setDepth(1100);const e=this.add.text(this.cameras.main.width/2,this.cameras.main.height/2,`PAUSED

Press P to Resume`,{fontSize:"24px",color:"#ffffff",fontFamily:"monospace",fontStyle:"bold",align:"center"});e.setOrigin(.5),e.setScrollFactor(0),e.setDepth(1101),this.data.set("pauseOverlay",[s,e])}else{this.scene.resume();const s=this.data.get("pauseOverlay");s&&(s.forEach(e=>e.destroy()),this.data.remove("pauseOverlay"))}}completeGame(t,s){var e;(e=this.gameCompleteCallback)==null||e.call(this,t||this.gameState.score,s||this.gameState.achievements)}saveGame(){var t;(t=this.gameSaveCallback)==null||t.call(this,this.gameState)}addToInventory(t){const s=this.gameState.inventory.find(e=>e.id===t.id);s?s.quantity+=t.quantity||1:this.gameState.inventory.push({id:t.id,name:t.name,type:t.type,quantity:t.quantity||1,description:t.description||""})}addAchievement(t){this.gameState.achievements.includes(t)||this.gameState.achievements.push(t)}}export{x as B};

var p=Object.defineProperty;var u=(d,c,e)=>c in d?p(d,c,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[c]=e;var n=(d,c,e)=>u(d,typeof c!="symbol"?c+"":c,e);import{P as r}from"./index-x1V5TmgY.js";import{B as y}from"./BaseGameScene-DWO2C2i8.js";class x extends y{constructor(e){super("RevealAdventureScene");n(this,"player");n(this,"currentArea","garden");n(this,"miniGames",[]);n(this,"clues",[]);n(this,"revealType","boy");n(this,"interactiveObjects");n(this,"npcs");n(this,"currentMiniGame",null);n(this,"miniGameContainer",null);n(this,"celebrationStarted",!1);n(this,"balloonPuzzle",null);n(this,"treasureHunt",null);n(this,"colorMatch",null);this.init(e)}preload(){console.log("RevealAdventureScene: Starting preload...");const e=this.add.graphics();e.fillStyle(10040012),e.fillRect(0,0,32,32),e.generateTexture("hero",32,32),e.clear(),e.fillStyle(16738740),e.fillRect(0,0,32,32),e.generateTexture("environment",32,32),e.clear(),e.fillStyle(16766720),e.fillCircle(8,8,6),e.generateTexture("items",16,16),e.destroy(),console.log("RevealAdventureScene: Preload complete!")}create(){var e;super.create(),this.revealType=(e=this.customization.specialMessage)!=null&&e.toLowerCase().includes("girl")?"girl":"boy",this.setupMiniGames(),this.setupClues(),this.createArea(),this.createPlayer(),this.createInteractives(),this.setupCollisions(),this.setupCamera(),this.showWelcomeMessage()}setupMiniGames(){this.miniGames=[{id:"balloon_pop",title:"Balloon Pop Challenge",description:"Pop all the balloons to find the hidden clue!",completed:!1,rewardClue:"The answer lies in the colors of nature..."},{id:"treasure_hunt",title:"Treasure Hunt",description:"Find all hidden treasures around the garden!",completed:!1,rewardClue:"Pink roses bloom for little princesses..."},{id:"color_match",title:"Color Memory Game",description:"Match the colored cards to unlock the secret!",completed:!1,rewardClue:"Blue skies welcome little princes..."}]}setupClues(){this.clues=[{id:"clue1",text:"Something special is coming...",found:!1},{id:"clue2",text:"The color holds the secret...",found:!1},{id:"clue3",text:"Love is growing in our hearts...",found:!1}]}createArea(){switch(this.currentArea){case"garden":this.createGarden();break;case"house":this.createHouse();break;case"celebration":this.createCelebration();break}}createGarden(){this.add.rectangle(400,300,800,600,9498256,.5),[{x:100,y:150},{x:700,y:120},{x:150,y:450},{x:650,y:480}].forEach(t=>{this.add.circle(t.x,t.y,40,2263842),this.add.rectangle(t.x,t.y+40,15,30,9127187)});for(let t=0;t<8;t++){const a=r.Math.Between(50,750),s=r.Math.Between(200,550);this.add.circle(a,s,8,this.revealType==="girl"?16761035:8900331)}this.add.rectangle(400,300,100,600,13808780,.7)}createHouse(){this.add.rectangle(400,300,800,600,16113331,.8),this.add.rectangle(400,350,400,200,14524637),this.add.triangle(400,250,0,100,200,0,400,100,9109504),this.add.rectangle(400,420,60,80,6636321),this.add.rectangle(330,350,40,40,8900331),this.add.rectangle(470,350,40,40,8900331)}createCelebration(){this.add.rectangle(400,300,800,600,this.revealType==="girl"?16761035:8900331,.3);const e=this.revealType==="girl"?[16738740,16761035,16716947]:[4286945,8900331,255];for(let t=0;t<20;t++){const a=r.Math.Between(50,750),s=r.Math.Between(50,200),i=this.add.circle(a,s,15,r.Utils.Array.GetRandom(e));this.tweens.add({targets:i,y:s-20,duration:2e3,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}this.createConfetti()}createConfetti(){const e=this.revealType==="girl"?[16738740,16761035,16716947,16766720]:[4286945,8900331,255,16766720];for(let t=0;t<50;t++){const a=this.add.rectangle(r.Math.Between(0,800),r.Math.Between(-100,0),4,8,r.Utils.Array.GetRandom(e));this.tweens.add({targets:a,y:700,rotation:Math.PI*4,duration:r.Math.Between(3e3,6e3),ease:"Linear",repeat:-1})}}createPlayer(){this.player=this.physics.add.sprite(400,500,"hero"),this.player.setSize(24,32),this.player.setBounce(.1),this.player.setCollideWorldBounds(!0),this.player.setTint(4286945),this.gameState.position&&this.player.setPosition(this.gameState.position.x,this.gameState.position.y)}createInteractives(){switch(this.interactiveObjects=this.physics.add.group(),this.npcs=this.physics.add.group(),this.currentArea){case"garden":this.createGardenInteractives();break;case"house":this.createHouseInteractives();break}}createGardenInteractives(){const e=this.physics.add.sprite(200,200,"items");e.setTint(16738740),e.setData("type","minigame"),e.setData("gameId","balloon_pop"),this.interactiveObjects.add(e);const t=this.physics.add.sprite(600,400,"items");t.setTint(16766720),t.setData("type","minigame"),t.setData("gameId","treasure_hunt"),this.interactiveObjects.add(t);const a=this.physics.add.sprite(400,150,"hero");a.setTint(9498256),a.setData("type","npc"),a.setData("dialogue",[`Welcome to the Gender Reveal Adventure, ${this.customization.characterName}!`,"Complete the mini-games to collect clues!","Each clue will help reveal the big surprise!"]),this.npcs.add(a)}createHouseInteractives(){const e=this.physics.add.sprite(400,350,"items");e.setTint(9662683),e.setData("type","minigame"),e.setData("gameId","color_match"),this.interactiveObjects.add(e)}setupCollisions(){this.physics.add.overlap(this.player,this.interactiveObjects,(e,t)=>{this.handleInteraction(t)}),this.physics.add.overlap(this.player,this.npcs,(e,t)=>{this.handleNPCInteraction(t)})}setupCamera(){this.cameras.main.startFollow(this.player),this.cameras.main.setBounds(0,0,800,600)}showWelcomeMessage(){const e=this.add.text(400,100,`Welcome, ${this.customization.characterName}!
A special surprise awaits...
Complete mini-games to discover clues!`,{fontSize:"16px",color:"#ffffff",fontFamily:"monospace",align:"center",backgroundColor:"#000000",padding:{x:12,y:8}});e.setOrigin(.5),this.time.delayedCall(4e3,()=>{e.destroy()})}handleInteraction(e){if(e.getData("type")==="minigame"){const a=e.getData("gameId"),s=this.miniGames.find(i=>i.id===a);s&&!s.completed?this.startMiniGame(s):s!=null&&s.completed&&this.showMessage("This mini-game is already completed!","#4ade80")}}handleNPCInteraction(e){const t=e.getData("dialogue");t&&t.length>0&&this.showDialogue(t)}showDialogue(e){const t=e.join(`

`),a=this.add.text(400,450,t,{fontSize:"14px",color:"#ffffff",fontFamily:"monospace",align:"center",backgroundColor:"#000000",padding:{x:15,y:10},wordWrap:{width:600}});a.setOrigin(.5),this.time.delayedCall(4e3,()=>{a.destroy()})}startMiniGame(e){switch(this.currentMiniGame=e,e.id){case"balloon_pop":this.startBalloonPop();break;case"treasure_hunt":this.startTreasureHunt();break;case"color_match":this.startColorMatch();break}}startBalloonPop(){this.miniGameContainer=this.add.container(400,300);const e=this.add.rectangle(0,0,700,500,0,.8);e.setStrokeStyle(3,16777215);const t=this.add.text(0,-200,`Balloon Pop Challenge!
Click all balloons!`,{fontSize:"18px",color:"#FFD700",fontFamily:"monospace",align:"center",fontStyle:"bold"});t.setOrigin(.5),this.miniGameContainer.add([e,t]);const a=[];[{x:-150,y:-80},{x:0,y:-100},{x:150,y:-70},{x:-100,y:0},{x:100,y:20},{x:-50,y:100},{x:80,y:80}].forEach((i,h)=>{const o=this.add.sprite(i.x,i.y,"items"),m=[16738740,8900331,16766720,9498256,16739179];o.setTint(m[h%m.length]),o.setInteractive(),o.setScale(1.5),o.on("pointerdown",()=>{this.tweens.add({targets:o,scaleX:0,scaleY:0,alpha:0,duration:200,onComplete:()=>{o.destroy(),a.splice(a.indexOf(o),1),a.length===0&&this.completeBalloonPop()}})}),this.tweens.add({targets:o,y:i.y-10,duration:1e3,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),a.push(o),this.miniGameContainer.add(o)}),this.balloonPuzzle={balloons:a,poppedCount:0}}completeBalloonPop(){this.showMessage("All balloons popped! Clue discovered!","#4ade80"),this.completeMiniGame("balloon_pop")}startTreasureHunt(){this.miniGameContainer=this.add.container(400,300);const e=this.add.rectangle(0,0,700,500,0,.8);e.setStrokeStyle(3,16777215);const t=this.add.text(0,-200,`Treasure Hunt!
Find all hidden treasures!`,{fontSize:"18px",color:"#FFD700",fontFamily:"monospace",align:"center",fontStyle:"bold"});t.setOrigin(.5),this.miniGameContainer.add([e,t]);const a=[];for(let s=0;s<5;s++){const i=this.add.sprite(r.Math.Between(-300,300),r.Math.Between(-150,150),"items");i.setTint(16766720),i.setInteractive(),i.setAlpha(.7),i.on("pointerdown",()=>{this.tweens.add({targets:i,scale:2,alpha:0,duration:300,onComplete:()=>{i.destroy(),a.splice(a.indexOf(i),1),a.length===0&&this.completeTreasureHunt()}})}),this.tweens.add({targets:i,alpha:.3,duration:800,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),a.push(i),this.miniGameContainer.add(i)}this.treasureHunt={treasures:a,foundCount:0}}completeTreasureHunt(){this.showMessage("All treasures found! Another clue unlocked!","#4ade80"),this.completeMiniGame("treasure_hunt")}startColorMatch(){this.miniGameContainer=this.add.container(400,300);const e=this.add.rectangle(0,0,700,500,0,.8);e.setStrokeStyle(3,16777215);const t=this.add.text(0,-200,`Color Memory Game!
Match pairs of colors!`,{fontSize:"18px",color:"#FFD700",fontFamily:"monospace",align:"center",fontStyle:"bold"});t.setOrigin(.5),this.miniGameContainer.add([e,t]);const a=[16738740,8900331,9498256,16766720],s=[...a,...a];r.Utils.Array.Shuffle(s);const i=[];[{x:-150,y:-80},{x:-50,y:-80},{x:50,y:-80},{x:150,y:-80},{x:-150,y:20},{x:-50,y:20},{x:50,y:20},{x:150,y:20}].forEach((o,m)=>{const l=this.add.sprite(o.x,o.y,"items");l.setTint(6710886),l.setInteractive(),l.setData("color",s[m]),l.setData("revealed",!1),l.setData("matched",!1),l.on("pointerdown",()=>{this.handleCardClick(l)}),i.push(l),this.miniGameContainer.add(l)}),this.colorMatch={cards:i,matches:0,firstCard:null,secondCard:null}}handleCardClick(e){this.colorMatch&&(e.getData("revealed")||e.getData("matched")||(e.setTint(e.getData("color")),e.setData("revealed",!0),this.colorMatch.firstCard?this.colorMatch.secondCard||(this.colorMatch.secondCard=e,this.time.delayedCall(500,()=>{this.checkColorMatch()})):this.colorMatch.firstCard=e))}checkColorMatch(){if(!this.colorMatch)return;const e=this.colorMatch.firstCard,t=this.colorMatch.secondCard;e.getData("color")===t.getData("color")?(e.setData("matched",!0),t.setData("matched",!0),this.colorMatch.matches++,this.colorMatch.matches===4&&this.completeColorMatch()):(e.setTint(6710886),t.setTint(6710886),e.setData("revealed",!1),t.setData("revealed",!1)),this.colorMatch.firstCard=null,this.colorMatch.secondCard=null}completeColorMatch(){this.showMessage("All pairs matched! Final clue revealed!","#4ade80"),this.completeMiniGame("color_match")}completeMiniGame(e){this.miniGameContainer&&(this.miniGameContainer.destroy(),this.miniGameContainer=null);const t=this.miniGames.find(a=>a.id===e);if(t){t.completed=!0;const a=this.clues.find(s=>!s.found);a&&(a.found=!0,this.showMessage(`Clue: ${t.rewardClue}`,"#FFD700")),this.gameState.score+=500,this.addToInventory({id:`clue_${e}`,name:`Clue from ${t.title}`,type:"key",description:t.rewardClue})}this.miniGames.every(a=>a.completed)&&this.time.delayedCall(2e3,()=>{this.startReveal()}),this.updateUI()}startReveal(){this.celebrationStarted||(this.celebrationStarted=!0,this.children.removeAll(),this.currentArea="celebration",this.createArea(),this.showGenderReveal())}showGenderReveal(){const e=this.revealType==="girl"?16738740:4286945,t=this.revealType==="girl"?"It's a GIRL!":"It's a BOY!",a=this.customization.specialMessage||`${this.customization.characterName||"Our"} bundle of joy`,s=this.add.text(400,200,t,{fontSize:"48px",color:r.Display.Color.IntegerToColor(e).rgba,fontFamily:"monospace",fontStyle:"bold",stroke:"#000000",strokeThickness:3});s.setOrigin(.5),s.setScale(0),this.tweens.add({targets:s,scale:1,duration:1e3,ease:"Back.easeOut"}),this.time.delayedCall(1500,()=>{this.add.text(400,300,a,{fontSize:"24px",color:"#ffffff",fontFamily:"monospace",align:"center",backgroundColor:"#000000",padding:{x:20,y:10}}).setOrigin(.5),this.createFireworks(),this.time.delayedCall(5e3,()=>{this.addAchievement("gender_revealed"),this.addAchievement("celebration_complete"),this.completeGame(this.gameState.score,this.gameState.achievements)})})}createFireworks(){for(let e=0;e<5;e++)this.time.delayedCall(e*800,()=>{const t=r.Math.Between(100,700),a=r.Math.Between(100,300);for(let s=0;s<20;s++){const i=this.add.circle(t,a,3,this.revealType==="girl"?16738740:4286945),h=s/20*Math.PI*2,o=r.Math.Between(50,150);this.tweens.add({targets:i,x:t+Math.cos(h)*o,y:a+Math.sin(h)*o,alpha:0,duration:1e3,ease:"Power2",onComplete:()=>i.destroy()})}})}showMessage(e,t="#ffffff"){const a=this.add.text(400,100,e,{fontSize:"16px",color:t,fontFamily:"monospace",align:"center",backgroundColor:"#000000",padding:{x:12,y:6}});a.setOrigin(.5),a.setDepth(1e3),this.time.delayedCall(3e3,()=>{a.destroy()})}update(){var s,i,h,o;let e=0,t=0;const a=160;(s=this.controls.keys)!=null&&s.left.isDown&&(e=-160),(i=this.controls.keys)!=null&&i.right.isDown&&(e=a),(h=this.controls.keys)!=null&&h.up.isDown&&(t=-160),(o=this.controls.keys)!=null&&o.down.isDown&&(t=a),this.controls.mobile&&(this.controls.mobile.left&&(e=-160),this.controls.mobile.right&&(e=a),this.controls.mobile.up&&(t=-160),this.controls.mobile.down&&(t=a)),this.player&&this.player.body&&this.player.body.setVelocity(e,t),this.player&&(this.gameState.position={x:this.player.x,y:this.player.y}),this.time.now%12e3<16&&this.saveGame()}}export{x as RevealAdventureScene};
